---
const lastUpdated = new Date();
---

<astro-updated data-lastupdated={lastUpdated} transition:persist>
  <span class="text-sm text-slate-500">🛠️...</span>
</astro-updated>

<script>
  import dayjs from "dayjs";
  import relativeTime from "dayjs/plugin/relativeTime";
  dayjs.extend(relativeTime);

  class Updated extends HTMLElement {
    constructor() {
      super();

      const date = this.dataset.lastupdated;
      const span = this.querySelector("span");
      if (span) {
        setTimeout(() => {
          span.textContent = `🛠️ Updated ${dayjs().to(dayjs(date))}`;
        }, 1000);
      }
    }
  }

  customElements.define("astro-updated", Updated);
</script>
