---
import { getEntries, type CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import { Icon } from "astro-icon";

import { Tooltip } from "@/components/Tooltip";

interface Props {
  post: CollectionEntry<"posts">;
}

const { post } = Astro.props;

const tagsData = await getEntries(post.data.tags);
---

<article class="flex flex-col text-center">
  <a href={`/blog/${post.slug}/`} class="rounded-2xl" data-astro-prefetch>
    <Image
      src={post.data.image}
      width="300"
      height="300"
      alt={post.data.title}
      class="aspect-[4/3] w-full rounded-2xl object-cover"
    />
  </a>

  <div class="mt-4 flex flex-1 flex-col">
    <h2 class="text-sm font-normal">
      {
        new Date(post.data.date).toLocaleDateString("en-NZ", {
          year: "numeric",
          month: "long",
          day: "numeric",
        })
      }
    </h2>

    <h2 class="mb-0 line-clamp-2 text-base">
      <a href={`/blog/${post.slug}/`} data-astro-prefetch>{post.data.title}</a>
    </h2>

    <div class="relative flex items-center justify-center gap-4">
      {
        tagsData.map(({ slug, data: tag }) => (
          <Tooltip client:visible title={tag.name}>
            <Icon name={slug} class="h-6 w-auto" />
          </Tooltip>
        ))
      }
    </div>
  </div>
</article>
