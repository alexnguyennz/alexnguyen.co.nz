---
import { getCollection } from "astro:content";
import { Icon } from "astro-icon";

import Layout from "@/layouts/Layout.astro";
import Logo from "@/components/Logo.astro";

import Tool from "@/components/Tool.astro";
import Project from "@/components/Project.astro";

const tools = (await getCollection("tools")).sort(
  (a, b) => a.data.order - b.data.order,
);

const projects = (await getCollection("projects")).sort(
  (a, b) => a.data.order - b.data.order,
);
---

<Layout>
  <section class="flex py-28 sm:h-screen">
    <div class="m-auto max-w-xl grow space-y-10 text-center">
      <Logo />

      <h2 class="text-4xl">Hi, I'm Alex â€” a web developer.</h2>

      <h3 class="text-2xl">
        <a href="#projects" class="contrast-link">
          My projects <Icon pack="tabler" name="arrow-down" class="h-6 w-6" />
        </a>
      </h3>

      <div class="space-y-5 text-xl">
        <h3 class="text-2xl">Some cool stuff I&apos;ve used:</h3>
        <ul class="space-y-3 sm:columns-2">
          {
            tools.map(({ slug, data: tool }) => (
              <Tool name={tool.name} slug={slug} url={tool.url} />
            ))
          }
        </ul>
      </div>

      <h3 class="text-2xl">
        <a href="mailto:me@alexnguyen.co.nz" class="contrast-link">
          Feel free to say hi <Icon
            pack="tabler"
            name="mailbox"
            class="h-6 w-6"
          />
        </a>
      </h3>
    </div>
  </section>

  <section id="projects" class="flex flex-col gap-12 py-28">
    <h2>/projects</h2>

    <div
      class="grid gap-10 text-left md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3"
    >
      {
        projects.map(({ slug, data: project }) => (
          <Project
            name={project.name}
            slug={slug}
            description={project.description}
            image={project.image}
            url={project.url}
            tags={project.tags}
          />
        ))
      }
    </div>
  </section>
</Layout>

<script>
  import Atropos from "atropos";
  import "atropos/css/min";

  document.querySelectorAll(".atropos").forEach((element) => {
    Atropos({
      el: element as string,
      shadow: false,
      highlight: false,
      rotateXMax: 12,
      rotateYMax: 12,
      rotateTouch: false,
    });
  });
</script>
