---
import { getEntries, type CollectionEntry } from "astro:content";

import { Image } from "astro:assets";
import { Icon } from "astro-icon";
import { cn } from "../../../lib/utils";

interface Props {
  project: CollectionEntry<"projects">;
}

const { project } = Astro.props;

const tags = await getEntries(project.data.tags);
---

<article
  class="group relative flex h-full max-w-xs flex-1 flex-col rounded-[3rem] border border-slate-200 bg-white p-5 shadow-sm transition duration-300 hover:translate-y-1 hover:shadow-md dark:border-slate-800 dark:bg-slate-900"
>
  <div
    class="absolute right-4 top-4 flex gap-2 transition group-hover:opacity-100 sm:opacity-0"
  >
    <a
      href={project.data.url}
      target="_blank"
      rel="noopener noreferrer nofollow"
      title="View"
      class="p-2 text-2xl no-underline hover:no-underline"
      aria-label={project.data.name + " link"}
    >
      â†—
    </a>
  </div>

  <div>
    <a href={`/project/${project.slug}`} data-astro-prefetch
      ><Image
        src={project.data.cover}
        height={192}
        alt={project.data.name}
        class="mx-auto mb-2 h-[128px] object-contain"
        loading="lazy"
      /></a
    >

    <div class="mt-auto">
      <h2>
        <a href={`/project/${project.slug}`} data-astro-prefetch>
          {project.data.name}
        </a>
      </h2>

      <div class="flex flex-col items-center gap-4">
        <h3 class="text-sm">{project.data.description}</h3>

        <div class="relative flex items-center justify-center gap-4">
          {
            tags.map(({ slug, data: tag }) => (
              <a
                href={tag.url}
                target="_blank"
                rel="noreferrer noopener nofollow"
                title={tag.name}
                aria-label={tag.name}
              >
                <Icon
                  name={slug}
                  class={cn(
                    "w-auto fill-[#034AD8]",
                    tag.name === "Nuxt" ? "h-8" : "h-6",
                  )}
                />
              </a>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</article>
