---
const lastUpdated = new Date();
---

<astro-updated data-lastupdated={lastUpdated} transition:persist>
  <span data-testid="updated" class="text-sm text-slate-500"
    >🛠️ <svg
      xmlns="http://www.w3.org/2000/svg"
      width="20"
      height="20"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="inline animate-pulse"
      ><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"
      ></circle><circle cx="5" cy="12" r="1"></circle></svg
    ></span
  >
</astro-updated>

<script>
  import dayjs from "dayjs";
  import relativeTime from "dayjs/plugin/relativeTime";
  dayjs.extend(relativeTime);

  class Updated extends HTMLElement {
    constructor() {
      super();

      const date = this.dataset.lastupdated;
      const span = this.querySelector("span");

      span!.textContent = `🛠️ Updated ${dayjs().to(dayjs(date))}`;
    }
  }

  customElements.define("astro-updated", Updated);
</script>
