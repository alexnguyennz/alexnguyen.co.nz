---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import { Icon } from "astro-icon";

import Layout from "@/layouts/Layout.astro";
import { Fade } from "@/components/Fade";

export const getStaticPaths = async () => {
  const projects = await getCollection("projects");

  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
};

const { project } = Astro.props;
const { Content } = await project.render();
---

<Layout title={project.data.name + " -"}>
  <Fade client:visible>
    <div class="flex items-center justify-center gap-3">
      <a href="/projects" aria-label="projects page"
        ><Icon pack="lucide" name="arrow-left" class="mt-1 h-7 w-7" /></a
      >
      <h1>
        {project.data.name}
      </h1>
    </div>
  </Fade>

  <Fade client:visible delay={0.25}>
    <div class="grid gap-10 xl:grid-cols-3">
      <a
        href={project.data.url}
        target="_blank"
        rel="noopener"
        aria-label={project.data.name + " link"}
        class="xl:col-span-2"
      >
        <div class="mx-auto w-full">
          <Image
            src={project.data.image}
            width={800}
            alt={project.data.name}
            class="h-auto rounded-2xl"
            fetchpriority="high"
            loading="eager"
          />
        </div>
      </a>
      <div class="markdown-body space-y-4">
        <Content />
      </div>
    </div>
  </Fade>
</Layout>
